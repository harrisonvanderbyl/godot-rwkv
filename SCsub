#!/usr/bin/env python

import os
Import('env')
Import('env_modules')
cwd = os.getcwd()
env_rwkv = env_modules.Clone()
# get cwd
cenv = os.getcwd()

env_rwkv.Prepend(
    LIBPATH=["/lib/x86_64-linux-gnu"])
# env.Prepend(RPATH=[libfolder,
#                    ])

# env_rwkv.Append(CPPDEFINES={'-D_GLIBCXX_USE_CXX11_ABI': 0})
# env_rwkv.Append(CPPDEFINES={'-DCMAKE_PREFIX_PATH': cenv+'/libtorch'})

# add pybind11
env_rwkv.Append(CPPPATH=['/usr/include/python3.10'])
# add ./pybind11/include
env_rwkv.Append(CPPPATH=['./pybind11/include'])


# add python library
env.Append(LIBS=['python3.10', "pthread"])
env.Append(LIBPATH=['/lib/x86_64-linux-gnu'])
# -Wl,-znodelete
env_rwkv.Append(LINKFLAGS=['-Wl,-znodelete'])

# use c++ 17
env_rwkv.Append(CPPFLAGS=['-std=c++17'])

# env_thirdparty.add_source_files(env.modules_sources, source)


# Godot's own source files
env_rwkv.add_source_files(env.modules_sources, "*.cpp")
